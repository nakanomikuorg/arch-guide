# åŸºç¡€å®‰è£…è¯¦è§£

> ### ğŸ”­ çŸ¥å…¶ç„¶ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶
>
> è¿™ä¸€èŠ‚å¯¹ä¸Šä¸€èŠ‚ [archlinux åŸºç¡€å®‰è£…](basic-install.md) ä¸­å…³é”®çš„å‡ æ­¥åšå‡ºäº†æ›´è¿›ä¸€æ­¥çš„è§£é‡Šï¼ŒçŸ¥å…¶ç„¶çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚æ­¤èŠ‚æ²¡æœ‰ç‰¹å®šé¡ºåºï¼Œå¯æ ¹æ®éœ€è¦é€‰æ‹©æ€§é˜…è¯»
>
> éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæœ¬æŒ‡å—å‡å®šä½ æœ‰ä¸€å®šçš„ Linux åŸºç¡€çŸ¥è¯†ï¼ŒåŸºç¡€çŸ¥è¯†ç›¸å…³çš„è¯é¢˜**ä¸ä¼š**è¢«è®¨è®º

## ğŸ’¾ åˆ†åŒºå’Œæ ¼å¼åŒ–

> 1. å› æœ¬æŒ‡å—ä»‹ç»ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ `Btrfs`ï¼Œå¾ˆå¤šèŒæ–°å¯èƒ½æœ‰äº›ä¸ç†è§£ã€‚è¿™é‡Œæœ‰å¿…è¦è¯´æ˜ä¸€ä¸‹
> 2. è‹¥**æ‰§æ„è¦ç”¨ä¼ ç»Ÿçš„ `ext4` æ–‡ä»¶ç³»ç»Ÿ**ï¼Œæœ¬æŒ‡å—ä¹Ÿç»™å‡ºäº†ç¤ºä¾‹
> 3. å¯¹äºå…¨ç›˜æ ¼å¼åŒ–å**å…¨æ–°å®‰è£…**çš„ï¼ˆå• archlinux ç³»ç»Ÿï¼‰åŒå­¦ï¼Œè¿™é‡Œä¹Ÿç»™å‡ºäº†éœ€è¦åšçš„é¢å¤–æ­¥éª¤çš„è¯´æ˜
> 4. å¯¹äº **Swap åˆ†åŒºè¿˜æ˜¯ Swap æ–‡ä»¶** çš„è¯é¢˜ï¼Œä¹Ÿä¼šåœ¨æ­¤è®¨è®º

### ğŸ’¾ ä¸ºä»€ä¹ˆè¦ç”¨ Btrfs æ–‡ä»¶ç³»ç»Ÿ

![Btrfs](../../assets/svg/btrfs-logo.svg)

çºµè§‚ Btrfs çš„å†å²ï¼Œå¯ä»¥è¯´ Btrfs æœªæ¥çš„å‘å±•æ˜¯é“é˜»ä¸”é•¿çš„ã€‚ä¹Ÿè®©æˆ‘ä»¬æ„Ÿå—åˆ°å¼€æºç¤¾åŒºä¹Ÿå¹¶ä¸æ˜¯ä¸€æ ¹ç»³ä¸Šçš„èš‚èš± â€”â€” å¼€æºç¤¾åŒºä¹‹é—´ä¹Ÿæœ‰ç€å„ç§å„æ ·çš„åˆ†æ­§ã€‚

ä½†ä¸ç®¡æ€ä¹ˆè¯´ï¼ŒBtrfs çš„æœªæ¥ç°åœ¨æ¥çœ‹æ˜¯å…‰æ˜çš„ï¼›æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ archlinux ä¸Šäº«å—åˆ° Btrfs æ–‡ä»¶ç³»ç»Ÿçš„ç‰¹æ€§å¸¦æ¥çš„å¥½å¤„ï¼š

1. å¿«ç…§ â€”â€” archlinux ä½œä¸ºæ»šåŠ¨å‘è¡Œç‰ˆï¼Œè‹¥æ»šæŒ‚äº†å¯ä»¥ä½¿ç”¨ Btrfs çš„å¿«ç…§ç‰¹æ€§å¿«é€Ÿå›æ»š
   - è‹¥ä½¿ç”¨ä¼ ç»Ÿçš„ `ext4` æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `timeshift` çš„ `RSYNC` æ¨¡å¼è¿›è¡Œå¢é‡å¤‡ä»½ã€‚ä½†æ˜¯ï¼Œä¸€èˆ¬æ¥è¯´ RSYNC æ–¹å¼çš„å¿«ç…§å¤§å°ç•¥å¤§äºå½“å‰å®é™…ä½¿ç”¨å¤§å°ï¼Œä¹Ÿå°±æ˜¯è¯´å®é™…ä¸Šå¼€å¯äº† `timeshift` çš„ `RSYNC` æ¨¡å¼å¿«ç…§ç›¸å½“äºç£ç›˜å¯ç”¨ç©ºé—´ç›´æ¥å°‘äº†ä¸€åŠå¤šã€‚å› ä¸ºè™½ç„¶ RSYNC æ–¹å¼çš„å¿«ç…§æ˜¯å¢é‡çš„ï¼Œä½†å†å²æœ€ä¹…è¿œçš„å¿«ç…§ä¾ç„¶æ˜¯å®Œæ•´å¤‡ä»½ï¼Œéšåæ‰æ˜¯å¢é‡çš„
2. é€æ˜å‹ç¼© â€”â€” å¯ä»¥å¤§å¤§å‡å°‘ç£ç›˜çš„ä½¿ç”¨ç©ºé—´ï¼ˆå‹ç¼©ç‡å¤§æ¦‚åœ¨ 10% å·¦å³ï¼‰

::: tip â„¹ï¸ æç¤º

æ›´å¤š Btrfs æ–‡ä»¶ç³»ç»Ÿä»‹ç»å’Œæ“ä½œè¯·å‚é˜… [Btrfs ä»‹ç»ä¸ç›¸å…³æ“ä½œ](../advanced/btrfs.md)ã€‚

:::

### ğŸ’¾ ä¼ ç»Ÿ ext4 æ–‡ä»¶ç³»ç»Ÿè¯´æ˜

è‹¥æ‰§æ„ä½¿ç”¨ä¼ ç»Ÿçš„ `ext4` æ–‡ä»¶ç³»ç»Ÿï¼Œé‚£ä¹ˆåˆ†åŒºçš„å»ºè®®ä¸ºï¼š

1. è‹¥ archlinux å®‰è£…åˆ†åŒºå°äº `256GB`ï¼š

   - `/` æ ¹ç›®å½•ï¼š`å…¨éƒ¨ç©ºé—´`ï¼ˆç”¨æˆ·ä¸»ç›®å½•ä¸å•ç‹¬åˆ†åŒºï¼‰
   - `/boot` EFI åˆ†åŒºï¼š`256MB`
   - Swap åˆ†åŒºï¼š`>= ç”µè„‘å®é™…è¿è¡Œå†…å­˜çš„ 60%`

2. è‹¥ archlinux å®‰è£…åˆ†åŒºå¤§äº `256GB`ï¼š

   - `/` æ ¹ç›®å½•ï¼š`128GB`
   - `/home` ç”¨æˆ·ä¸»ç›®å½•ï¼š`å‰©ä½™çš„å…¨éƒ¨ç©ºé—´`
   - `/boot` EFI åˆ†åŒºï¼š`256MB`
   - Swap åˆ†åŒºï¼š`>= ç”µè„‘å®é™…è¿è¡Œå†…å­˜çš„ 60%`

åˆ†åŒºåŒæ ·ä½¿ç”¨ `cfdisk` å·¥å…·ï¼Œå…·ä½“æ“ä½œç±»ä¼¼ä¸Šä¸€èŠ‚ [7-1. åˆ†åŒº](./basic-install.html#_7-1-åˆ†åŒº) æ‰€è¿°ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚

- ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ ¼å¼åŒ– `ext4` åˆ†åŒºï¼š

::: code-group

```zsh [SATA]
mkfs.ext4 /dev/sdax
```

```zsh [NVME]
mkfs.ext4 /dev/nvmexn1pn
```

:::

- ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‚è½½ `ext4` åˆ†åŒºï¼š

::: code-group

```zsh [SATA]
mount /dev/sdxn /mnt
mkdir /mnt/home # è‹¥ /home ç›®å½•å•ç‹¬åˆ†åŒº
mount /dev/sdxn /mnt/home # è‹¥ /home ç›®å½•å•ç‹¬åˆ†åŒº
mkdir -p /mnt/boot
mount /dev/sdxn /mnt/boot
```

```zsh [NVME]
mount /dev/nvmexn1pn /mnt
mkdir /mnt/home # è‹¥ /home ç›®å½•å•ç‹¬åˆ†åŒº
mount /dev/nvmexn1pn /mnt/home # è‹¥ /home ç›®å½•å•ç‹¬åˆ†åŒº
mkdir -p /mnt/boot
mount /dev/nvmexn1pn /mnt/boot
```

:::

### ğŸ†• å…¨æ–°å®‰è£…

è‹¥ä¸ºå…¨æ–°å®‰è£…ï¼ˆå• archlinux ç³»ç»Ÿï¼‰ï¼Œé¦–å…ˆè¦å¯¹ç£ç›˜å»ºç«‹æ–°çš„ GPT åˆ†åŒºè¡¨ï¼›åŒæ—¶ï¼Œç”±äºæ²¡æœ‰ç°å­˜çš„ EFI åˆ†åŒºï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æ‰‹åŠ¨åˆ›å»ºå®ƒï¼ˆè¿™ä¸€æ­¥åœ¨ [7. åˆ†åŒºå’Œæ ¼å¼åŒ–ï¼ˆä½¿ç”¨ Btrfs æ–‡ä»¶ç³»ç»Ÿï¼‰](basic-install.md#_7-åˆ†åŒºå’Œæ ¼å¼åŒ–-ä½¿ç”¨-btrfs-æ–‡ä»¶ç³»ç»Ÿ) æ­¥éª¤ä¹‹å‰ï¼‰ï¼š

#### 1. å»ºç«‹æ–°çš„ GPT åˆ†åŒºè¡¨

1. åŒæ ·çš„ï¼Œå…ˆé€šè¿‡ `lsblk` å‘½ä»¤ï¼ŒåŒºåˆ†è¦å…¨æ–°å®‰è£… archlinux çš„ç£ç›˜ï¼ˆé€šè¿‡è§‚å¯Ÿç£ç›˜çš„å¤§å°ç­‰åˆ¤æ–­ï¼‰ï¼š

```zsh
lsblk # æ˜¾ç¤ºå½“å‰åˆ†åŒºæƒ…å†µ
```

2. é€šè¿‡ä»¥ä¸‹å‘½ä»¤å°†ç£ç›˜è½¬æ¢ä¸º `gpt` ç±»å‹ï¼š

::: code-group

```zsh [SATA]
parted /dev/sdx # æ‰§è¡Œ partedï¼Œè¿›è¡Œç£ç›˜ç±»å‹å˜æ›´
(parted) mktable # è¾“å…¥ mktable
New disk label type? gpt # è¾“å…¥ gptï¼Œå°†ç£ç›˜ç±»å‹è½¬æ¢ä¸º GPT ç±»å‹ã€‚å¦‚ç£ç›˜æœ‰æ•°æ®ä¼šè­¦å‘Šï¼Œè¾“å…¥ Yes å³å¯
(parted) quit # é€€å‡º parted å‘½ä»¤è¡Œäº¤äº’
```

```zsh [NVME]
parted /dev/nvmexn1 # æ‰§è¡Œ partedï¼Œè¿›è¡Œç£ç›˜ç±»å‹å˜æ›´
(parted) mktable # è¾“å…¥ mktable
New disk label type? gpt # è¾“å…¥ gptï¼Œå°†ç£ç›˜ç±»å‹è½¬æ¢ä¸º GPT ç±»å‹ã€‚å¦‚ç£ç›˜æœ‰æ•°æ®ä¼šè­¦å‘Šï¼Œè¾“å…¥ Yes å³å¯
(parted) quit # é€€å‡º parted å‘½ä»¤è¡Œäº¤äº’
```

:::

::: danger â˜¢ï¸ è­¦å‘Š

é‡å»ºåˆ†åŒºè¡¨ä¼šä½¿ç£ç›˜æ‰€æœ‰æ•°æ®ä¸¢å¤±ï¼Œè¯·äº‹å…ˆç¡®è®¤ã€‚

:::

#### 2. å»ºç«‹ EFI åˆ†åŒº

è¿›å…¥ `cfdisk` åˆ†åŒºå·¥å…·ä¹‹åï¼Œç±»ä¼¼ä¸Šä¸€èŠ‚æ­¥éª¤ [7-1. åˆ†åŒº](basic-install.md#_7-1-åˆ†åŒº) çš„åˆ†åŒºè¯´æ˜ï¼Œå»ºç«‹ EFI åˆ†åŒºï¼š

1. é€‰ä¸­ `Free space` > å†é€‰ä¸­æ“ä½œ `[New]` > ç„¶åæŒ‰ä¸‹å›è½¦ `Enter` ä»¥æ–°å»º `EFI` åˆ†åŒº

2. è¾“å…¥ `åˆ†åŒºå¤§å°`ï¼ˆå»ºè®® >= `256MB`ã€<= `1024MB`ï¼›æ¨è `512MB`ï¼‰> ç„¶åæŒ‰ä¸‹å›è½¦ `Enter`

3. é€‰ä¸­æ“ä½œ `[Type]` > ç„¶åæŒ‰ä¸‹å›è½¦ `Enter` > é€šè¿‡æ–¹å‘é”® `â†‘` å’Œ `â†“` é€‰ä¸­ `EFI System` > æœ€åæŒ‰ä¸‹å›è½¦ `Enter`

4. æ¥ä¸‹æ¥å¯ä»¥æŒ‰ç…§ä¸Šä¸€èŠ‚ [7-1. åˆ†åŒº](basic-install.md#_7-1-åˆ†åŒº) çš„æ­¥éª¤åˆ›å»ºå…¶å®ƒåˆ†åŒº

#### 3. æ ¼å¼åŒ– EFI åˆ†åŒº

::: code-group

```zsh [SATA]
mkfs.vfat /dev/sdxn
```

```zsh [NVME]
mkfs.vfat /dev/nvmexn1pn
```

:::

### ğŸ’¾ Swap åˆ†åŒºå’Œ Swap æ–‡ä»¶

å¦‚æœå¸Œæœ›ä½¿ç”¨ Swap æ–‡ä»¶æ›¿æ¢ Swap åˆ†åŒºï¼Œé‚£ä¹ˆåœ¨åˆ†åŒºå’ŒæŒ‚è½½ä¸­ä¸å¿…åˆ›å»ºå’Œå¼€å¯ Swap åˆ†åŒºã€‚

::: tip â„¹ï¸ æç¤º

ä½†æ˜¯ï¼Œä½¿ç”¨ Swap æ–‡ä»¶ä¼šæ›´åŠ å¤æ‚ã€‚å› ä¸ºè‹¥ä½¿ç”¨ Swap æ–‡ä»¶åœ¨ `Btrfs` æ–‡ä»¶ç³»ç»Ÿä¸­è®¾ç½®ä¼‘çœ ï¼ˆhibernateï¼‰çš„æ—¶å€™éœ€è¦é¢å¤–çš„æ­¥éª¤ï¼Œè€Œä¸”å¯èƒ½æœ‰å…¼å®¹æ€§é—®é¢˜ã€‚è‹¥æ²¡æœ‰åŠ¨æ€æ”¹å˜ Swap å¤§å°çš„éœ€æ±‚ï¼Œå»ºè®®ä½¿ç”¨ Swap åˆ†åŒºã€‚

:::

é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ›å»ºå’ŒæŒ‚è½½ Swap æ–‡ä»¶ï¼ˆè¿™ä¸€æ­¥åœ¨ [18. å®Œæˆå®‰è£…](basic-install.md#_18-å®Œæˆå®‰è£…) æ­¥éª¤ä¹‹åï¼‰ï¼š

1. é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ›å»º Swap Fileï¼š

```bash
sudo dd if=/dev/zero of=/swapfile bs=1M count=16384 status=progress # åˆ›å»º 16G çš„äº¤æ¢ç©ºé—´ï¼ˆå¤§å° >= ç”µè„‘å®é™…è¿è¡Œå†…å­˜çš„ 60%ï¼‰
sudo chmod 600 /swapfile # è®¾ç½®æ­£ç¡®çš„æƒé™
sudo mkswap /swapfile # æ ¼å¼åŒ– Swap æ–‡ä»¶
sudo swapon /swapfile # æŒ‚è½½ Swap æ–‡ä»¶
```

2. é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŒ‚è½½ Swap æ–‡ä»¶ï¼š

```bash
swapon /swapfile
```

3. ä½¿ç”¨ `free` å‘½ä»¤å¤æŸ¥ Swap æ–‡ä»¶æŒ‚è½½æƒ…å†µï¼š

```zsh
free -h # -h é€‰é¡¹ä¼šä½¿è¾“å‡ºä»¥äººç±»å¯è¯»çš„å•ä½æ˜¾ç¤º
```

4. æœ€åï¼Œå‘ `/etc/fstab` ä¸­è¿½åŠ å¦‚ä¸‹å†…å®¹ï¼š

```fstab
/swapfile  none  swap  defaults  0 0
```

## ğŸ’½ å®‰è£…ç¯å¢ƒå’Œæ–°ç³»ç»Ÿçš„å…³ç³»

> ç†è§£å®‰è£…ç¯å¢ƒå’Œæ–°ç³»ç»Ÿçš„å…³ç³»ï¼Œå¯¹äºç†è§£ archlinux å®‰è£…æ—¶æ‰€åšçš„æ­¥éª¤å…·æœ‰é‡å¤§æ„ä¹‰ã€‚å¯ä»¥è¯´ï¼Œç†è§£äº†å®ƒä»¬çš„å…³ç³»åŸºæœ¬ä¸Šå°±ç†è§£äº† archlinux çš„å®‰è£…

ä¸ºäº†ç”ŸåŠ¨å½¢è±¡çš„ç†è§£å®‰è£…ç¯å¢ƒå’Œæ–°ç³»ç»Ÿçš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®‰è£…ç³»ç»Ÿçš„è¿‡ç¨‹æƒ³è±¡æˆæ¬å®¶ ğŸ ã€‚

### 1. ğŸ  å»ºæˆ¿å­

æˆ‘ä»¬å¯ä»¥å°†å®‰è£…ç¯å¢ƒæ¯”å–»æˆä¸€ä¸ªä¸´æ—¶çš„å®¶ã€‚ä¸ºäº†ä½è¿›æ–°å®¶ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠæ–°å®¶çš„æˆ¿å­å»ºèµ·æ¥ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ [7. åˆ†åŒºå’Œæ ¼å¼åŒ–](basic-install.md#_7-åˆ†åŒºå’Œæ ¼å¼åŒ–-ä½¿ç”¨-btrfs-æ–‡ä»¶ç³»ç»Ÿ)ã€‚åœ¨ç£ç›˜ä¸Šå»ºç«‹æ–°çš„åˆ†åŒºå¹¶æ ¼å¼åŒ–ï¼Œå°±å¥½æ¯”åœ¨ç©ºä½™çš„åœŸåœ°ä¸Šå»ºç«‹èµ·æ–°çš„æˆ¿å­ã€‚

### 2. ğŸ›£ï¸ å»ºç«‹é€šé“

æ–°æˆ¿å»ºå¥½äº†ï¼Œæˆ‘ä»¬é¦–å…ˆè¿˜è¦å»ºç«‹ä¸€æ¡è”é€šæ—§å®¶å’Œæ–°å®¶ä¹‹é—´çš„é€šé“ â€”â€” ä¸ç„¶æˆ‘ä»¬æ€ä¹ˆèµ°åˆ°æ–°å®¶å»å‘¢ï¼æ›´ä¸è¦æå°†å®¶å…·ä»€ä¹ˆçš„å®‰ç½®åˆ°æ–°å®¶å»äº†ã€‚è¿™ä¸ªæ­¥éª¤å°±æ˜¯ [8. æŒ‚è½½](/guide/rookie/basic-install.md#_8-æŒ‚è½½)ã€‚é€šè¿‡å°†æ–°çš„åˆ†åŒºæŒ‚è½½åˆ° `/mnt` ä¸‹ï¼Œæˆ‘ä»¬æ‰èƒ½å¯¹æ–°çš„åˆ†åŒºè¿›è¡Œæ“ä½œã€‚

### 3. ğŸ›‹ï¸ æ·»ç½®å®¶å…·

å…‰æœ‰ä¸€ä¸ªç©ºè¡è¡çš„æˆ¿å­æ˜¯æ²¡æœ‰ç”¨çš„ã€‚ä¸ºäº†å˜æˆä¸€ä¸ªèƒ½å¤Ÿç”Ÿæ´»çš„æ¸©é¦¨å°çªï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ·»ç½®å®¶å…·ã€‚è¿™ä¸ªæ­¥éª¤å°±æ˜¯ [9. å®‰è£…ç³»ç»Ÿ](basic-install.md#_9-å®‰è£…ç³»ç»Ÿ)ã€‚åœ¨æ‰§è¡Œ `pacstrap` è„šæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®å°±æ˜¯å°†ç³»ç»Ÿè¿è¡Œéœ€è¦çš„ä¸€äº›åŸºç¡€çš„ä¸œè¥¿å®‰è£…åˆ°æ–°çš„ç³»ç»Ÿä¸­ â€”â€” ç±»ä¼¼æŠŠå®¶å…·æ”¾åˆ°æ–°çš„å®¶é‡Œã€‚

### 4. ğŸšš æ¬è¿›æ–°å®¶

æœ€åï¼Œæ–°å®¶å»ºå¥½äº†ï¼Œè£…ä¿®å•Šã€å®¶å…·å•Šä¹Ÿå¼„å¥½äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ¬è¿›æ–°å®¶äº†ï¼è¿™ä¸€æ­¥éª¤å°±æ˜¯ [11. change root](./basic-install.html#_11-change-root)ã€‚`arch-chroot` è„šæœ¬æ˜¯è½¯ä»¶åŒ… [`arch-install-scripts`](https://archlinux.org/packages/?name=arch-install-scripts) çš„ä¸€éƒ¨åˆ†ï¼Œä½†æœ¬è´¨ä¸Šåªæ˜¯åœ¨ `chroot` å‘½ä»¤çš„åŸºç¡€ä¸Šæ·»åŠ äº†ä¸€äº›åŠŸèƒ½ï¼Œç®€åŒ–äº†â€œæ¬å®¶â€çš„æµç¨‹ã€‚å…¶ç±»ä¼¼ï¼ˆæ³¨æ„ï¼Œåªæ˜¯ç±»ä¼¼ï¼Œ`arch-chroot` è¿˜ä¼šåšä¸€äº›å…¶å®ƒçš„å·¥ä½œï¼Œå®‰è£…æ—¶è¯·ä½¿ç”¨ `arch-chroot`ï¼‰ä»¥ä¸‹å‘½ä»¤ï¼š

```zsh
mount -t proc none /mnt/proc
mount -t sysfs none /mnt/sys
mount -o bind /dev /mnt/dev
chroot /mnt bash
```

`chroot` é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ **ch**ange **root** çš„æ„æ€ã€‚`chroot` å‘½ä»¤æŠŠæ ¹ç›®å½•æ¢æˆæŒ‡å®šçš„ç›®å½•ã€‚é€šå¸¸ï¼Œåˆ‡æ¢æ ¹ç›®å½•ä¸€èˆ¬çš„ç›®çš„æ˜¯ä¸ºäº†ç³»ç»Ÿç»´æŠ¤ï¼Œä¾‹å¦‚é‡è£…å¼•å¯¼ç¨‹åºæˆ–è€…é‡ç½®é—å¿˜çš„å¯†ç ï¼›è€Œåœ¨å®‰è£…æ—¶åˆ™æ˜¯ä¸ºäº†å®‰è£…ï¼ˆå¤§é›¾ ğŸŒ«ï¸ã€‚åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œæ–°çš„æ ¹ç›®å½•å°±æ˜¯ `/mnt`ã€‚è¿™ä¸ªè¿‡ç¨‹å°±å¥½æ¯”ä»åŸæ¥çš„å®¶æ¬åˆ°äº†æ–°çš„å®¶ä¸€æ ·ï¼Œæ˜¯ä¸æ˜¯è¿™æ ·ç†è§£èµ·æ¥å°±ç®€å•ä¸€ç‚¹äº†å‘¢ï¼Ÿ

## ğŸ¥™ æ‚ä¸ƒæ‚å…«

å…¶å®ƒçç¢çš„é—®é¢˜ä¸åœ¨ä¸€ä¸€å±•å¼€å™è¿°ï¼Œè¿™é‡Œé€šè¿‡åˆ—è¡¨ç»Ÿä¸€è¯´æ˜ï¼š

1. EFI åˆ†åŒºï¼ˆåˆç§° esp åˆ†åŒºï¼‰ä¸ä¸€å®šè¦æŒ‚è½½åœ¨ `/boot` ç›®å½•ä¸‹ï¼›ä¹Ÿå¯ä»¥æ˜¯ `/efi` æˆ–è€…å…¶ä»–éå¸¸è§è·¯å¾„ï¼ˆå½“ç„¶ä¸€èˆ¬æ¨èæŒ‚è½½åœ¨ `/boot` ä¸‹ï¼Œæ–¹ä¾¿å¼•å¯¼ç¨‹åºè¯»å–åŒæ ·åœ¨è¿™ä¸ªç›®å½•ä¸‹çš„å†…æ ¸ã€å¾®ç ç­‰å¯åŠ¨ç³»ç»Ÿçš„å¿…è¦æ–‡ä»¶ï¼‰
2. è‹¥ä¸º**è”æƒ³å°æ–° Pro14 / YOGA 14s 2021** æœºå‹ï¼Œå‘ç°å®‰è£…å‰åé”®ç›˜éƒ½æ— æ³•æ­£å¸¸å·¥ä½œã€‚æ­¤æ—¶å®‰è£…æ—¶è¯·ä½¿ç”¨å¤–æ¥é”®ç›˜ã€‚ä¸ºäº†è§£å†³è¯¥é—®é¢˜ï¼Œåœ¨ [17. å®‰è£…å¼•å¯¼ç¨‹åº](./basic-install.html#_17-å®‰è£…å¼•å¯¼ç¨‹åº) æ­¥éª¤ä¸­ç¼–è¾‘ `/etc/default/grub` æ–‡ä»¶æ—¶æ·»åŠ é¢å¤–çš„ GRUB å‚æ•° â€”â€” åœ¨ `GRUB_CMDLINE_LINUX_DEFAULT` è¿™ä¸€è¡Œä¸­æ·»åŠ å‚æ•° `i8042.dumbkbd`

ä¿®æ”¹åå¤æŸ¥ï¼š

```bash
head /etc/default/grub
```

è¾“å‡ºå¦‚ä¸‹ï¼š

```grub {8}
# GRUB boot loader configuration

GRUB_DEFAULT_SUBMENU=y
GRUB_DEFAULT=saved
GRUB_SAVEDEFAULT=true
GRUB_TIMEOUT=2
GRUB_DISTRIBUTOR="Arch"
GRUB_CMDLINE_LINUX_DEFAULT="loglevel=5 nowatchdog i8042.dumbkbd"
GRUB_CMDLINE_LINUX=""
```

3. è‹¥ä¸ºæœºæ¢°é©å‘½æœºå‹ï¼Œåˆ™å»ºè®®é€šè¿‡ CPIO archive ä¿®å¤

æœ¬éƒ¨åˆ†æ¥æºäºï¼š[æœºæ¢°é©å‘½ è›Ÿé¾™ 15K Linux å†…ç½®é”®ç›˜å¤±çµè§£å†³ (ACPI)_linux ç¬”è®°æœ¬é”®ç›˜å¤±çµ](https://blog.csdn.net/ZGY_121/article/details/134834265)

å·¥å…·ï¼šacpicaå’Œcpio

```bash
sudo pacman -S acpica cpio
```

è·å¾—åŸæ¥çš„ DSDT

```bash
cat /sys/firmware/acpi/tables/DSDT > dsdt.dat # è·å–dsdt
iasl -d dsdt.dat # åç¼–è¯‘DSDTæˆAMLæ–‡ä»¶(.dsl)
```

ä¿®æ”¹ dsdt.dsl ï¼š æ‰¾åˆ° Device(PS2K) ï¼Œå‘ä¸‹æ‰¾ç¬¬ä¸€ä¸ª ActiveLow æ”¹æˆ ActiveHigh ï¼Œæ ·ä¾‹å¦‚ä¸‹ï¼š

```
Device (PS2K)
{                                             
    Name (_HID, "MSFT0001")  // _HID: Hardware ID
    Name (_CID, EisaId ("PNP0303") /* IBM Enhanced Keyboard (101/102-key, PS/2 Mouse) */)  // _CID: Compatible ID
    Method (_STA, 0, NotSerialized)  // _STA: Status
    {                    
        Return (0x0F)
    }                    
    
    Name (_CRS, ResourceTemplate ()  // _CRS: Current Resource Settings
    {
        IO (Decode16,
            0x0060,             // Range Minimum
            0x0060,             // Range Maximum
            0x00,               // Alignment
            0x01,               // Length
            )
        IO (Decode16,
            0x0064,             // Range Minimum
            0x0064,             // Range Maximum
            0x00,               // Alignment
            0x01,               // Length
            )
        IRQ (Edge, ActiveLow, Shared, ) // <<=== ç›®æ ‡
            {1}
    })
//... çœç•¥æ— å…³å†…å®¹
}
```

æœ€åï¼Œç»™DefinitionBlock å‡ä¸€ä¸ªç‰ˆæœ¬ (æœ€åä¸€ä¸ªåå…­è¿›åˆ¶æ•°åŠ ä¸€)ï¼š `DefinitionBlock ("", "DSDT", 2, "ALASKA", "A M I ", 0x01072009)` æ”¹ä¸º `DefinitionBlock ("", "DSDT", 2, "ALASKA", "A M I ", 0x0107200A)`

ç¼–è¯‘æ–°çš„ AML æ–‡ä»¶

```bash
iasl dsdt.dsl
```
åŠ å…¥ initrd

```
mkdir -p kernel/firmware/acpi
cp dsdt.aml kernel/firmware/acpi
find kernel | cpio -H newc --create > acpi_override
sudo cp acpi_override /boot
echo "GRUB_EARLY_INITRD_LINUX_CUSTOM=\"acpi_override\"" >> /etc/default/grub
sudo grub-mkconfig -o /boot/grub/grub.cfg
```

::: tip â„¹ï¸ æç¤º

å¦‚æœä½¿ç”¨ systemd-boot , åˆ™åªéœ€è¦åœ¨å†…æ ¸åŠ è½½åå†åŠ ä¸€æ¡ `initrd` å‘½ä»¤å³å¯ï¼Œæ ·ä¾‹å¦‚ä¸‹ï¼š

```
# Created by: archinstall
# Created on: 2024-07-28_08-06-24
title   Arch Linux (linux-zen)
linux   /vmlinuz-linux-zen
initrd  /acpi_override # è¿™ä¸€è¡Œ
initrd  /initramfs-linux-zen.img
options root=PARTUUID=d1204e8c-13ab-4c8d-a6fd-45d731684912 zswap.enabled=0 rootflags=subvol=@ rw rootfstype=btrfs
```

:::
